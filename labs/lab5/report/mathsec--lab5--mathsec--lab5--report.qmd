---
# Preamble

## Author
author:
  name: Кармацкий Никита Сергеевич
  degrees: BSc
  orcid: 0000-0002-0877-7063
  email: 1032259402@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Лабораторная работа №5"
subtitle: "Вероятностные алгоритмы проверки чисел на простоту"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
      % --- Math fonts fallback: prefer plex-math; else unicode-math; else AMS ---
      \makeatletter
      \IfFileExists{plex-math.sty}{%
        \usepackage{plex-math}% IBM Plex Math if available
      }{%
        \IfFileExists{unicode-math.sty}{%
          \usepackage{unicode-math}% Unicode math
          \setmathfont{Latin Modern Math}% default math font
        }{%
          \usepackage{amsmath,amssymb}% classic math fallback
        }%
      }
      \makeatother
      % --- end fallback ---
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

**Цель работы**

Основная цель работы -- изучить и реализовать вероятностные алгоритмы проверки чисел на простоту.

**Задачи**

С помощью языка программирования Julia реализовать:
- Тест Ферма,
- Тест Соловея-Штрассена,
- Тест Миллера-Рабина.

# Выполнение лабораторной работы

Тест Ферма — это простой вероятностный тест на простоту числа, основанный на малой теореме Ферма. Если число nn простое, то для любого числа a, взаимно простого с n, выполняется равенство:a^(n−1)≡1(mod n). Если это равенство не выполняется для некоторого aa, число nn точно составное. Однако, если равенство выполняется, nn может быть как простым, так и составным (так называемые числа Кармайкла), поэтому тест Ферма не всегда надёжен.

```julia
function test_ferma(n)
    if n < 5
        throw(ArgumentError("N must be >= 5"))
    end
    a = rand(2:(n-2))
    r = powermod(a, n-1, n)
    if r == 1
        println("Число $n, вероятно, простое")
    else
        println("Число $n составное")
    end
end    
```

Реализуем функцию для нахождения символа Якоби

```julia
function jacobi_symbol(n, a)
    if n < 3
        throw(ArgumentError("n must be >= 3"))
    end
    if !(a >= 0 && a < n)
        throw(ArgumentError("a=$a must be >=0 and <$n"))
    end
    
    g = 1
    a_current = a
    n_current = n
    
    while true
        if a_current == 0
            return 0
        end
        if a_current == 1
            return g
        end
        
        k = 0
        a1 = a_current
        s = 1
        
        # Выносим степени двойки
        while a1 % 2 == 0
            a1 ÷= 2
            k += 1
        end

        if k % 2 == 0
            s = 1
        else
            if abs(n_current) % 8 == 1
                s = 1
            elseif abs(n_current) % 8 == 3
                s = -1
            end
        end
        
        if a1 == 1
            return g * s
        end
        
        if n_current % 4 == 3 && a1 % 4 == 3
            s = -s
        end
        
        # Обновляем значения для следующей итерации
        a_current = n_current % a1
        n_current = a1
        g = g * s
    end
end
```

Тест Соловея-Штрассена — вероятностный тест простоты, предложенный в 1970-х годах. Он улучшает тест Ферма, используя символ Якоби. Для простого числа nn и числа a, взаимно простого с n, выполняется: a^(n−1/2)≡(a/n)(mod n)где (a/n) — символ Якоби. Если равенство не выполняется, число составное. Тест более точен, чем тест Ферма, но всё ещё вероятностный.

``` julia
function solovei_shtrassen(n)
    if n < 5
        throw(ArgumentError("n must be >= 5"))
    end
    a = rand(2:(n-2))
    exponent = (n - 1) ÷ 2
    r = powermod(a, exponent, n)
    if r != 1 && r != n-1
        println("Число $n составное")
        return
    end
    jacobi = jacobi_symbol(n, a)
    if r != mod(jacobi, n)
        println("Число $n составное")
        return
    end
    println("Число $n, вероятно, простое")
end
```

Тест Миллера-Рабина — один из самых популярных вероятностных тестов простоты. Он основан на разложении n−1 в виде 2s^d, где d нечётно, и проверяет определённые условия для случайно выбранных оснований a. Если число не проходит проверку, оно точно составное. Если проходит — вероятно простое с очень высокой степенью уверенности. Тест широко используется благодаря своей эффективности и надёжности.

```julia
function miller_rabin(n)
    if n < 5
        throw(ArgumentError("n must be >= 5"))
    end
    
    r = n - 1
    s = 0
    while r % 2 == 0
        r ÷= 2
        s += 1
    end

    a = rand(2:(n-2))
    y = powermod(a, r, n)
    
    if y != 1 && y != n-1
        j = 1
        while j < s && y != n-1
            y = powermod(y, 2, n)
            if y == 1
                println("Число $n составное")
                return
            end
            j += 1
        end
        
        if y != n-1
            println("Число $n составное")
            return
        end
    end
    
    println("Число $n, вероятно, простое")
end
```

Тестирование:

```julia
println("Тест Ферма:")
test_ferma(17)
test_ferma(21)

println("\nТест Соловея-Штрассена:")
solovei_shtrassen(17)
solovei_shtrassen(21)

println("\nТест Миллера-Рабина")
miller_rabin(17)
miller_rabin(21)
```

В результате тестирования получим следующий результат: 

![Результат работы программы](image/image.png){#fig-001 width="70%"}

# Заключение

С помощью языка программирования Julia были реализованы:

- Тест Ферма,
- Тест Соловея-Штрассена,
- Тест Миллера-Рабина.
  
# Список литературы

1. JuliaLang [Электронный ресурс]. 2024 JuliaLang.org contributors. URL: https: //julialang.org/ (дата обращения: 11.10.2024).
2. Julia 1.11 Documentation [Электронный ресурс]. 2024 JuliaLang.org contributors. URL: https://docs.julialang.org/en/v1/ (дата обращения: 11.10.2024).