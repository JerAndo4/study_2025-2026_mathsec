---
# Preamble

## Author
author:
  name: Кармацкий Никита Сергеевич
  degrees: BSc
  email: 1032259402@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Лабораторная работа №5"
subtitle: "Вероятностные алгоритмы проверки чисел на простоту"
license: "CC BY"
date: 2025-09-04
## Generic options
lang: ru-RU
crossref:
  lof-title: Список иллюстраций
  lot-title: Список таблиц
  lol-title: Листинги
## Formats
format:
### Pdf output format
  beamer:
    toc: true
    toc-title: Содержание
    number-sections: true
    colorlinks: false
    toc-depth: 2
    slide_level: 2
    aspectratio: 169
    section-titles: true
    theme: metropolis
    themeoptions: progressbar=frametitle,sectionpage=progressbar,numbering=fraction
#### Language
    babel-lang: russian
    babel-otherlangs: english
### Html output
  revealjs:
    transition: slide
    margin: 0.2
    smaller: false
    output-ext: html
    theme: beige
    logo: _resources/image/logo_rudn.png
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Кармацкий Никикта Сергеевич
  * студент группы НФИмд-01-25
  * Российский университет дружбы народов им. П. Лумумбы
  * [1032259402@rudn.ru](mailto:1032259402@rudn.ru)

:::
::: {.column width="30%"}

![](./image/ava.jpg)

:::
::::::::::::::

# Введение

**Цель работы**

Основная цель работы -- изучить и реализовать вероятностные алгоритмы проверки чисел на простоту.

**Задачи**

С помощью языка программирования Julia реализовать:
- Тест Ферма,
- Тест Соловея-Штрассена,
- Тест Миллера-Рабина.

# Тест Ферма

```julia
function test_ferma(n)
    if n < 5
        throw(ArgumentError("N must be >= 5"))
    end
    a = rand(2:(n-2))
    r = powermod(a, n-1, n)
    if r == 1
        println("Число $n, вероятно, простое")
    else
        println("Число $n составное")
    end
end  
```

# Нахождения символа Якоби 1

```julia
function jacobi_symbol(n, a)
    if n < 3
        throw(ArgumentError("n must be >= 3"))
    end
    if !(a >= 0 && a < n)
        throw(ArgumentError("a=$a must be >=0 and <$n"))
    end
    
    g = 1
    a_current = a
    n_current = n
```

# Нахождения символа Якоби 2

```julia
    while true
        if a_current == 0
            return 0
        end
        if a_current == 1
            return g
        end
        
        k = 0
        a1 = a_current
        s = 1
        
        # Выносим степени двойки
        while a1 % 2 == 0
            a1 ÷= 2
            k += 1
        end
```

# Нахождения символа Якоби 3

```julia
        if k % 2 == 0
            s = 1
        else
            if abs(n_current) % 8 == 1
                s = 1
            elseif abs(n_current) % 8 == 3
                s = -1
            end
        end
        
        if a1 == 1
            return g * s
        end
```

# Нахождения символа Якоби 3

```julia
        if n_current % 4 == 3 && a1 % 4 == 3
            s = -s
        end
        
        # Обновляем значения для следующей итерации
        a_current = n_current % a1
        n_current = a1
        g = g * s
    end
end
```

# Тест Соловея-Штрассена

```julia
function solovei_shtrassen(n)
    if n < 5
        throw(ArgumentError("n must be >= 5"))
    end
    a = rand(2:(n-2))
    exponent = (n - 1) ÷ 2
    r = powermod(a, exponent, n)
    if r != 1 && r != n-1
        println("Число $n составное")
        return
    end
    jacobi = jacobi_symbol(n, a)
    if r != mod(jacobi, n)
        println("Число $n составное")
        return
    end
    println("Число $n, вероятно, простое")
end
```

# Тест Миллера-Рабина  1

```julia
function miller_rabin(n)
    if n < 5
        throw(ArgumentError("n must be >= 5"))
    end
    
    r = n - 1
    s = 0
    while r % 2 == 0
        r ÷= 2
        s += 1
    end

    a = rand(2:(n-2))
    y = powermod(a, r, n)
```

# Расширенный бинарный алгоритм Евклида 3

```julia
    if y != 1 && y != n-1
        j = 1
        while j < s && y != n-1
            y = powermod(y, 2, n)
            if y == 1
                println("Число $n составное")
                return
            end
            j += 1
        end        
        if y != n-1
            println("Число $n составное")
            return
        end
    end  
    println("Число $n, вероятно, простое")
end
```

# Тестирование:

```julia
println("Тест Ферма:")
test_ferma(17)
test_ferma(21)

println("\nТест Соловея-Штрассена:")
solovei_shtrassen(17)
solovei_shtrassen(21)

println("\nТест Миллера-Рабина")
miller_rabin(17)
miller_rabin(21)
```

# Результат работы программы

![Результат работы программы](image/image.png){#fig-001 width="70%"}

# Заключение

С помощью языка программирования Julia были реализованы:

- Тест Ферма,
- Тест Соловея-Штрассена,
- Тест Миллера-Рабина.
  

# Список литературы

1. JuliaLang [Электронный ресурс]. 2024 JuliaLang.org contributors. URL: https: //julialang.org/ (дата обращения: 11.10.2024).
2. Julia 1.11 Documentation [Электронный ресурс]. 2024 JuliaLang.org contributors. URL: https://docs.julialang.org/en/v1/ (дата обращения: 11.10.2024).